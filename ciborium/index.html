<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><meta name="generator" content="rustdoc"><meta name="description" content="Welcome to Ciborium!"><title>ciborium - Rust</title><link rel="preload" as="font" type="font/woff2" crossorigin href="../static.files/SourceSerif4-Regular-46f98efaafac5295.ttf.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../static.files/FiraSans-Regular-018c141bf0843ffd.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../static.files/FiraSans-Medium-8f9a781e4970d388.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../static.files/SourceCodePro-Regular-562dcc5011b6de7d.ttf.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../static.files/SourceSerif4-Bold-a2c9cd1067f8b328.ttf.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../static.files/SourceCodePro-Semibold-d899c5a5c4aeb14a.ttf.woff2"><link rel="stylesheet" href="../static.files/normalize-76eba96aa4d2e634.css"><link rel="stylesheet" href="../static.files/rustdoc-9bb858ba049f1f21.css" id="mainThemeStyle"><meta name="rustdoc-vars" data-root-path="../" data-static-root-path="../static.files/" data-current-crate="ciborium" data-themes="" data-resource-suffix="" data-rustdoc-version="1.72.0 (5680fa18f 2023-08-23)" data-channel="1.72.0" data-search-js="search-f6292fe389d70017.js" data-settings-js="settings-de11bff964e9d4e5.js" data-settings-css="settings-8c76f75bfb6bd192.css" data-theme-light-css="light-0f8c037637f9eb3e.css" data-theme-dark-css="dark-1097f8e92a01e3cf.css" data-theme-ayu-css="ayu-614652228113ac93.css" ><script src="../static.files/storage-59fd9b8ccb335783.js"></script><script defer src="../crates.js"></script><script defer src="../static.files/main-0795b7d26be81095.js"></script><noscript><link rel="stylesheet" media="(prefers-color-scheme:light)" href="../static.files/light-0f8c037637f9eb3e.css"><link rel="stylesheet" media="(prefers-color-scheme:dark)" href="../static.files/dark-1097f8e92a01e3cf.css"><link rel="stylesheet" href="../static.files/noscript-13285aec31fa243e.css"></noscript><link rel="alternate icon" type="image/png" href="../static.files/favicon-16x16-8b506e7a72182f1c.png"><link rel="alternate icon" type="image/png" href="../static.files/favicon-32x32-422f7d1d52889060.png"><link rel="icon" type="image/svg+xml" href="../static.files/favicon-2c020d218678b618.svg"></head><body class="rustdoc mod crate"><!--[if lte IE 11]><div class="warning">This old browser is unsupported and will most likely display funky things.</div><![endif]--><nav class="mobile-topbar"><button class="sidebar-menu-toggle">&#9776;</button><a class="logo-container" href="../ciborium/index.html"><img class="rust-logo" src="../static.files/rust-logo-151179464ae7ed46.svg" alt="logo"></a><h2></h2></nav><nav class="sidebar"><a class="logo-container" href="../ciborium/index.html"><img class="rust-logo" src="../static.files/rust-logo-151179464ae7ed46.svg" alt="logo"></a><h2 class="location"><a href="#">Crate ciborium</a></h2><div class="sidebar-elems"><ul class="block"><li class="version">Version 0.2.1</li><li><a id="all-types" href="all.html">All Items</a></li></ul><section><ul class="block"><li><a href="#modules">Modules</a></li><li><a href="#macros">Macros</a></li><li><a href="#enums">Enums</a></li><li><a href="#functions">Functions</a></li></ul></section></div></nav><main><div class="width-limiter"><nav class="sub"><form class="search-form"><span></span><input class="search-input" name="search" aria-label="Run search in the documentation" autocomplete="off" spellcheck="false" placeholder="Click or press ‘S’ to search, ‘?’ for more options…" type="search"><div id="help-button" title="help" tabindex="-1"><a href="../help.html">?</a></div><div id="settings-menu" tabindex="-1"><a href="../settings.html" title="settings"><img width="22" height="22" alt="Change settings" src="../static.files/wheel-7b819b6101059cd0.svg"></a></div></form></nav><section id="main-content" class="content"><div class="main-heading"><h1>Crate <a class="mod" href="#">ciborium</a><button id="copy-path" title="Copy item path to clipboard"><img src="../static.files/clipboard-7571035ce49a181d.svg" width="19" height="18" alt="Copy item path"></button></h1><span class="out-of-band"><a class="srclink" href="../src/ciborium/lib.rs.html#3-222">source</a> · <button id="toggle-all-docs" title="collapse all docs">[<span>&#x2212;</span>]</button></span></div><details class="toggle top-doc" open><summary class="hideme"><span>Expand description</span></summary><div class="docblock"><p>Welcome to Ciborium!</p>
<p>Ciborium contains CBOR serialization and deserialization implementations for serde.</p>
<h2 id="quick-start"><a href="#quick-start">Quick Start</a></h2>
<p>You’re probably looking for <a href="fn.from_reader.html" title="fn ciborium::from_reader"><code>from_reader()</code></a>
and <a href="fn.into_writer.html" title="fn ciborium::into_writer"><code>into_writer()</code></a>, which are
the main functions. Note that byte slices are also readers and writers and can be
passed to these functions just as streams can.</p>
<p>For dynamic CBOR value creation/inspection, see <a href="enum.Value.html" title="enum ciborium::Value"><code>Value</code></a>.</p>
<h2 id="design-decisions"><a href="#design-decisions">Design Decisions</a></h2><h3 id="always-serialize-numeric-values-to-the-smallest-size"><a href="#always-serialize-numeric-values-to-the-smallest-size">Always Serialize Numeric Values to the Smallest Size</a></h3>
<p>Although the CBOR specification has differing numeric widths, this is only
a form of compression on the wire and is not intended to directly
represent an “integer width” or “float width.” Therefore, ciborium always
serializes numbers to the smallest possible lossless encoding. For example,
we serialize <code>1u128</code> as a single byte (<code>01</code>). Likewise, we will also freely
decode that single byte into a <code>u128</code>.</p>
<p>While there is some minor performance cost for this, there are several
reasons for this choice. First, the specification seems to imply it by
using a separate bit for the sign. Second, the specification requires
that implementations handle leading zeroes; a liberal reading of which
implies a requirement for lossless coercion. Third, dynamic languages like
Python have no notion of “integer width,” making this is a practical
choice for maximizing wire compatibility with those languages.</p>
<p>This coercion is <strong>always</strong> lossless. For floats, this implies that we
only coerce to a smaller size if coercion back to the original size has
the same raw bits as the original.</p>
<h3 id="compatibility-with-other-implementations"><a href="#compatibility-with-other-implementations">Compatibility with Other Implementations</a></h3>
<p>The ciborium project follows the <a href="https://en.wikipedia.org/wiki/Robustness_principle">Robustness Principle</a>.
Therefore, we aim to be liberal in what we accept. This implies that we
aim to be wire-compatible with other implementations in decoding, but
not necessarily encoding.</p>
<p>One notable example of this is that <code>serde_cbor</code> uses fixed-width encoding
of numbers and doesn’t losslessly coerce. This implies that <code>ciborium</code> will
successfully decode <code>serde_cbor</code> encodings, but the opposite may not be the
case.</p>
<h3 id="representing-map-as-a-sequence-of-values"><a href="#representing-map-as-a-sequence-of-values">Representing Map as a Sequence of Values</a></h3>
<p>Other serde parsers have generally taken the route of using <code>BTreeMap</code> or
<code>HashMap</code> to implement their encoding’s underlying <code>Map</code> type. This crate
chooses to represent the <code>Map</code> type using <code>Vec&lt;(Value, Value)&gt;</code> instead.</p>
<p>This decision was made because this type preserves the order of the pairs
on the wire. Further, for those that need the properties of <code>BTreeMap</code> or
<code>HashMap</code>, you can simply <code>collect()</code> the values into the respective type.
This provides maximum flexibility.</p>
<h3 id="low-level-library"><a href="#low-level-library">Low-level Library</a></h3>
<p>The ciborium crate has the beginnings of a low-level library in the
(private) <code>basic</code> module. We may extend this to be more robust and expose
it for application consumption once we have it in a good state. If you’d
like to collaborate with us on that, please contact us. Alternatively,
we might fork this code into a separate crate with no serde dependency.</p>
<h3 id="internal-types"><a href="#internal-types">Internal Types</a></h3>
<p>The ciborium crate contains a number of internal types that implement
useful serde traits. While these are not currently exposed, we might
choose to expose them in the future if there is demand. Generally, this
crate takes a conservative approach to exposing APIs to avoid breakage.</p>
<h3 id="packed-encoding"><a href="#packed-encoding">Packed Encoding?</a></h3>
<p>Packed encoding uses numerical offsets to represent structure field names
and enum variant names. This can save significant space on the wire.</p>
<p>While the authors of this crate like packed encoding, it should generally
be avoided because it can be fragile as it exposes invariants of your Rust
code to remote actors. We might consider adding this in the future. If you
are interested in this, please contact us.</p>
</div></details><h2 id="modules" class="small-section-header"><a href="#modules">Modules</a></h2><ul class="item-table"><li><div class="item-name"><a class="mod" href="de/index.html" title="mod ciborium::de">de</a></div><div class="desc docblock-short">Serde deserialization support for CBOR</div></li><li><div class="item-name"><a class="mod" href="ser/index.html" title="mod ciborium::ser">ser</a></div><div class="desc docblock-short">Serde serialization support for CBOR</div></li><li><div class="item-name"><a class="mod" href="tag/index.html" title="mod ciborium::tag">tag</a></div><div class="desc docblock-short">Contains helper types for dealing with CBOR tags</div></li><li><div class="item-name"><a class="mod" href="value/index.html" title="mod ciborium::value">value</a></div><div class="desc docblock-short">A dynamic CBOR value</div></li></ul><h2 id="macros" class="small-section-header"><a href="#macros">Macros</a></h2><ul class="item-table"><li><div class="item-name"><a class="macro" href="macro.cbor.html" title="macro ciborium::cbor">cbor</a></div><div class="desc docblock-short">Build a <code>Value</code> conveniently.</div></li></ul><h2 id="enums" class="small-section-header"><a href="#enums">Enums</a></h2><ul class="item-table"><li><div class="item-name"><a class="enum" href="enum.Value.html" title="enum ciborium::Value">Value</a></div><div class="desc docblock-short">A representation of a dynamic CBOR value that can handled dynamically</div></li></ul><h2 id="functions" class="small-section-header"><a href="#functions">Functions</a></h2><ul class="item-table"><li><div class="item-name"><a class="fn" href="fn.from_reader.html" title="fn ciborium::from_reader">from_reader</a></div><div class="desc docblock-short">Deserializes as CBOR from a type with <a href="../ciborium_io/trait.Read.html" title="trait ciborium_io::Read"><code>impl ciborium_io::Read</code></a></div></li><li><div class="item-name"><a class="fn" href="fn.into_writer.html" title="fn ciborium::into_writer">into_writer</a></div><div class="desc docblock-short">Serializes as CBOR into a type with <a href="../ciborium_io/trait.Write.html" title="trait ciborium_io::Write"><code>impl ciborium_io::Write</code></a></div></li></ul></section></div></main></body></html>